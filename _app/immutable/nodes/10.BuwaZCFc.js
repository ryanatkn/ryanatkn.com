import"../chunks/DsnmJJEf.js";import{D as ge,E as At,X as Pt,b4 as Ot,W as Ct,a4 as zt,a8 as he,a5 as Nt,H as Ht,ao as Ft,ae as Lt,N as Rt,P as Ut,h as je,g as Wt,u as Ge,b5 as Yt,b3 as Bt,b6 as dt,C as qt,b7 as Gt,p as Z,f as S,d as f,r as h,s as D,b as y,c as K,V as ee,a as J,e as R,am as re,T as i,aS as Xe,at as ut,U as b,t as L,b8 as Ve,b9 as Xt,Q as Ee,as as Vt,k as Fe,ba as Jt,aI as ht,$ as Zt}from"../chunks/jmc0MsaE.js";import{s as $,f as ft,a as Kt}from"../chunks/CkuT1fe1.js";import{p as T,i as E}from"../chunks/CoJHoqp-.js";import{a as ie,C as vt,S as Le,b as N,s as _t,r as mt,c as Be}from"../chunks/384Md1Nf.js";import{s as Qt,a as gt,b as $t}from"../chunks/BoguTfBF.js";import{t as X,s as V}from"../chunks/Bq--mf1f.js";import{b as ea}from"../chunks/CuXEu-ZB.js";import{h as Re}from"../chunks/Dh6h1kb0.js";import{a as le,n as Je,g as tt,b as ta,e as aa,m as at,c as Me,f as Ue,F as na}from"../chunks/Dla8A37B.js";import{s as Se,o as sa,a as nt,m as oa}from"../chunks/C-_V8m2x.js";import{A as ia}from"../chunks/BNMaxgoo.js";import{c as ra}from"../chunks/CV6HjYPZ.js";import{b as la}from"../chunks/05u48N-i.js";function ca(t,e,a){ge&&At();var s=t,n=Ft,o,r,c=null,l=Ot;function m(){o&&Lt(o),c!==null&&(c.lastChild.remove(),s.before(c),c=null),o=r}Pt(()=>{if(l(n,n=e())){var d=s,g=Nt();g&&(c=document.createDocumentFragment(),c.append(d=Ct())),r=zt(()=>a(d)),g?he.add_callback(m):m()}}),ge&&(s=Ht)}function da(t,e){ge&&Rt(Ut(t)),je(()=>{var a=e();for(var s in a){var n=a[s];n?t.style.setProperty(s,n):t.style.removeProperty(s)}})}function ua(t,e,a){Wt(()=>{var s=Ge(()=>e(t,a?.())||{});if(a&&s?.update){var n=!1,o={};je(()=>{var r=a();Yt(r),n&&Bt(o,r)&&(o=r,s.update(r))}),n=!0}if(s?.destroy)return()=>s.destroy()})}function ha(t,e,a=e){var s=new WeakSet;dt(t,"input",async n=>{var o=n?t.defaultValue:t.value;if(o=We(t)?Ye(o):o,a(o),he!==null&&s.add(he),await qt(),o!==(o=e())){var r=t.selectionStart,c=t.selectionEnd;t.value=o??"",c!==null&&(t.selectionStart=r,t.selectionEnd=Math.min(c,t.value.length))}}),(ge&&t.defaultValue!==t.value||Ge(e)==null&&t.value)&&(a(We(t)?Ye(t.value):t.value),he!==null&&s.add(he)),je(()=>{var n=e();if(t===document.activeElement){var o=Gt??he;if(s.has(o))return}We(t)&&n===Ye(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function fa(t,e,a=e){dt(t,"change",s=>{var n=s?t.defaultChecked:t.checked;a(n)}),(ge&&t.defaultChecked!==t.checked||Ge(e)==null)&&a(t.checked),je(()=>{var s=e();t.checked=!!s})}function We(t){var e=t.type;return e==="number"||e==="range"}function Ye(t){return t===""?null:+t}const va=ra(),_a=t=>t?t.constructor===Object||t.constructor===void 0:!1,ma=Object.freeze({}),yt=t=>!t||!_a(t)?t:Object.fromEntries(Object.entries(t).sort((e,a)=>e[0]>a[0]?1:-1).map(([e,a])=>[e,yt(a)])),st="application/vnd.github+json",ga="2022-11-28",Ze=async(t,e)=>{const{request:a,params:s,parse:n,token:o,cache:r,return_early_from_cache:c,log:l,fetch:m=globalThis.fetch}=e??ma,d=typeof t=="string"?new URL(t):t,g=d.href,_=a?.method??(s?"POST":"GET");let v,p;if(r&&(p=wa(g,s,_),v=r.get(p),c&&v))return l?.info("[fetch_value] cached locally and returning early",g),l?.debug("[fetch_value] cached value",v),{ok:!0,value:v.value,headers:ot(v)};const x=a?.body??(_==="GET"||_==="HEAD"?null:JSON.stringify(s??{})),u=new Headers(a?.headers);u.has("accept")||u.set("accept",d.hostname==="api.github.com"?st:"application/json"),u.get("accept")===st&&!u.has("x-github-api-version")&&u.set("x-github-api-version",ga),x&&!u.has("content-type")&&u.set("content-type","application/json"),o&&!u.has("authorization")&&u.set("authorization","Bearer "+o);const k=v?.etag;if(k&&!u.has("if-none-match"))u.set("if-none-match",k);else{const U=v?.last_modified;U&&!u.has("if-modified-since")&&u.set("if-modified-since",U)}const O=new Request(d,{...a,headers:u,method:_,body:x});l?.info("[fetch_value] fetching url with headers",t),l?.debug("[fetch_value] fetching with headers",ya(u));const M=await m(O);if(l?.info("[fetch_value] fetched",t,M.status,pa(M.headers)),l?.debug("[fetch_value] fetched",Object.fromEntries(M.headers.entries())),M.status===429)throw Error("ratelimited exceeded fetching url "+t);if(M.status===304){if(!v)throw Error("unexpected 304 status without a cached value");return l?.info("[fetch_value] cache hit",t),{ok:!0,value:v.value,headers:ot(v)}}if(!M.ok)return{ok:!1,status:M.status,message:M.statusText};const H=M.headers.get("content-type"),B=await(!H||H.includes("json")?M.json():M.text()),C=n?n(B):B;if(l?.debug("[fetch_value] fetched json",t,C),p){const U={key:p,url:g,params:s,value:C,etag:M.headers.get("etag"),last_modified:M.headers.get("etag")?null:M.headers.get("last-modified")};r.set(p,U)}return{ok:!0,value:C,headers:M.headers}},ot=t=>{const e=new Headers;return t.etag&&e.set("etag",t.etag),t.last_modified&&e.set("last-modified",t.last_modified),e},ya=t=>{const e=Object.fromEntries(t.entries());return e.authorization&&(e.authorization="[REDACTED]"),e},pa=t=>{const e=t.get("x-ratelimit-limit"),a=t.get("x-ratelimit-remaining");return e||a?`ratelimit ${a} of ${e}`:""},pt=Se(),ba=sa({key:pt,url:Se(),params:nt(),value:nt(),etag:Se().nullable(),last_modified:Se().nullable()});oa(pt,ba);const it="::",wa=(t,e,a)=>{let s=a+it+t;return e!=null&&(s+=it+JSON.stringify(yt(e))),s};function Te(t,e){const a=+le(t)-+le(e);return a<0?-1:a>0?1:a}function xa(t,e,a){const[s,n]=Je(a?.in,t,e),o=s.getFullYear()-n.getFullYear(),r=s.getMonth()-n.getMonth();return o*12+r}function ka(t){return e=>{const a=Math.trunc,s=a(e);return s===0?0:s}}function Ia(t,e){return+le(t)-+le(e)}function Da(t,e){const a=le(t,e?.in);return a.setHours(23,59,59,999),a}function Ma(t,e){const a=le(t,e?.in),s=a.getMonth();return a.setFullYear(a.getFullYear(),s+1,0),a.setHours(23,59,59,999),a}function Sa(t,e){const a=le(t,e?.in);return+Da(a,e)==+Ma(a,e)}function Ta(t,e,a){const[s,n,o]=Je(a?.in,t,t,e),r=Te(n,o),c=Math.abs(xa(n,o));if(c<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-r*c);let l=Te(n,o)===-r;Sa(s)&&c===1&&Te(s,o)===1&&(l=!1);const m=r*(c-+l);return m===0?0:m}function Ea(t,e,a){const s=Ia(t,e)/1e3;return ka()(s)}function rt(t,e,a){const s=ta(),n=a?.locale??s.locale??aa,o=2520,r=Te(t,e);if(isNaN(r))throw new RangeError("Invalid time value");const c=Object.assign({},a,{addSuffix:a?.addSuffix,comparison:r}),[l,m]=Je(a?.in,...r>0?[e,t]:[t,e]),d=Ea(m,l),g=(tt(m)-tt(l))/1e3,_=Math.round((d-g)/60);let v;if(_<2)return _===0?n.formatDistance("lessThanXMinutes",1,c):n.formatDistance("xMinutes",_,c);if(_<45)return n.formatDistance("xMinutes",_,c);if(_<90)return n.formatDistance("aboutXHours",1,c);if(_<at){const p=Math.round(_/60);return n.formatDistance("aboutXHours",p,c)}else{if(_<o)return n.formatDistance("xDays",1,c);if(_<Me){const p=Math.round(_/at);return n.formatDistance("xDays",p,c)}else if(_<Me*2)return v=Math.round(_/Me),n.formatDistance("aboutXMonths",v,c)}if(v=Ta(m,l),v<12){const p=Math.round(_/Me);return n.formatDistance("xMonths",p,c)}else{const p=v%12,x=Math.trunc(v/12);return p<3?n.formatDistance("aboutXYears",x,c):p<9?n.formatDistance("overXYears",x,c):n.formatDistance("almostXYears",x+1,c)}}var ja=S("<span><span><!></span><span><!></span><span><!></span></span>");function Aa(t,e){Z(e,!0);const a=T(e,"running",3,!0);var s=ja();ie(s,u=>({...e.attrs,class:`pending_animation ${e.attrs?.class??""}`,[vt]:u}),[()=>({running:a(),display_flex:!e.inline,display_inline_flex:e.inline,align_items_center:e.inline})],void 0,"svelte-18ylyg9");var n=f(s);ie(n,()=>({...e.item_attrs,[Le]:{"animation-delay":"0s"}}),void 0,void 0,"svelte-18ylyg9");var o=f(n);{var r=u=>{var k=ee(),O=J(k);R(O,()=>e.children,()=>0),y(u,k)},c=u=>{var k=re("•");y(u,k)};E(o,u=>{e.children?u(r):u(c,!1)})}h(n);var l=D(n);ie(l,()=>({...e.item_attrs,[Le]:{"animation-delay":"0.09s"}}),void 0,void 0,"svelte-18ylyg9");var m=f(l);{var d=u=>{var k=ee(),O=J(k);R(O,()=>e.children,()=>1),y(u,k)},g=u=>{var k=re("•");y(u,k)};E(m,u=>{e.children?u(d):u(g,!1)})}h(l);var _=D(l);ie(_,()=>({...e.item_attrs,[Le]:{"animation-delay":"0.3s"}}),void 0,void 0,"svelte-18ylyg9");var v=f(_);{var p=u=>{var k=ee(),O=J(k);R(O,()=>e.children,()=>2),y(u,k)},x=u=>{var k=re("•");y(u,k)};E(v,u=>{e.children?u(p):u(x,!1)})}h(_),h(s),y(t,s),K()}var Pa=S('<span class="animation svelte-cvss5b"><!></span>'),Oa=S('<button><span class="content svelte-cvss5b"><!></span> <!></button>');function Ca(t,e){Z(e,!0);let a=Xe(void 0);var n={focus:d=>i(a)?.focus(d)},o=Oa();ie(o,d=>({type:"button",...e.attrs,disabled:e.disabled??e.attrs?.disabled??e.pending,title:e.title??e.attrs?.title,onclick:e.onclick,[vt]:d}),[()=>({pending:e.pending})],void 0,"svelte-cvss5b");var r=f(o),c=f(r);R(c,()=>e.children),h(r);var l=D(r,2);{var m=d=>{var g=Pa(),_=f(g);{var v=x=>{var u=ee(),k=J(u);R(k,()=>e.animation),y(x,u)},p=x=>{Aa(x,{get running(){return e.running}})};E(_,x=>{e.animation?x(v):x(p,!1)})}h(g),y(d,g)};E(l,d=>{e.pending&&d(m)})}return h(o),ea(o,d=>ut(a,d),()=>i(a)),y(t,o),K(n)}const za=(t,e)=>{let a,s,n,o,r,c,l,m;const d=v=>{m=v,c=0,typeof v=="function"?(a=v,s=void 0,n=void 0,o=void 0):v&&(a=v.onintersect,s=v.ondisconnect,n=v.count,o=v.options),g()},g=()=>{l&&_(),!(m===null||n===0)&&(l=new IntersectionObserver(v=>{r=v[0].isIntersecting,a&&l&&a({intersecting:r,intersections:c,el:t,observer:l,disconnect:_}),r?c++:n&&n>0&&c>=n&&_()},o),l.observe(t))},_=()=>{l&&(l.disconnect(),s&&s({intersecting:r,intersections:c,el:t,observer:l}),l=null)};return d(e),{update:v=>{d(v)},destroy:_}};var Na=S('<div class="content panel p_md mb_lg svelte-1nc1gfs"><!></div>'),Ha=S("<details><summary> </summary><!></details>"),Fa=S('<div class="mastodon_status_item svelte-1nc1gfs"><header class="svelte-1nc1gfs"><button type="button" class="avatar plain icon_button svelte-1nc1gfs"><img class="icon svelte-1nc1gfs"/></button> <div class="names svelte-1nc1gfs"><div class="name svelte-1nc1gfs"><a> </a></div> <small class="svelte-1nc1gfs"> </small> <small class="date svelte-1nc1gfs"><a class="svelte-1nc1gfs"> </a></small></div></header> <!> <div class="content svelte-1nc1gfs"><!></div></div>');function qe(t,e){Z(e,!0);const a=b(()=>e.item.created_at),s=b(()=>e.item.edited_at),n=b(()=>e.item.content),o=b(()=>e.item.account),r=b(()=>e.item.url),c=b(()=>e.item.sensitive),l=b(()=>e.item.spoiler_text),m=b(()=>i(o).created_at),d=b(()=>i(o).avatar_static),g=b(()=>i(o).url),_=b(()=>i(o).display_name),v=b(()=>i(o).followers_count),p=b(()=>i(o).following_count),x=b(()=>i(o).acct),u=b(()=>i(o).note),k=b(()=>Ue(new Date(i(m)),"PPpp")),O=b(()=>rt(new Date,new Date(i(a)))),M=b(()=>i(s)?Ue(new Date(i(s)),"PPpp"):null),H=b(()=>i(s)?rt(new Date,new Date(i(s))):null),B=b(()=>Ue(new Date(i(m)),"MMM yyyy"));let C=Xe(!1);const U=()=>{ut(C,!i(C))};var Q=Fa(),F=f(Q),A=f(F);A.__click=function(...P){(i(u)?U:void 0)?.apply(this,P)};var q=f(A);h(A);var fe=D(A,2),te=f(fe),ae=f(te),Ae=f(ae,!0);h(ae),h(te);var ne=D(te,2),se=f(ne,!0);h(ne);var ce=D(ne,2),oe=f(ce),ye=f(oe);h(oe),h(ce),h(fe),h(F);var pe=D(F,2);{var ve=P=>{var z=Na(),W=f(z);Re(W,()=>i(u)),h(z),X(3,z,()=>V),y(P,z)};E(pe,P=>{i(C)&&i(u)&&P(ve)})}var _e=D(pe,2),Pe=f(_e);{var Oe=P=>{var z=Ha(),W=f(z),ze=f(W,!0);h(W);var be=D(W);Re(be,()=>i(n)),h(z),L(()=>$(ze,i(l)||"view sensitive content")),y(P,z)},Ce=P=>{var z=ee(),W=J(z);Re(W,()=>i(n)),y(P,z)};E(Pe,P=>{i(c)?P(Oe):P(Ce,!1)})}h(_e),h(Q),L(P=>{N(A,"title",i(u)?`${i(C)?"hide":"show"} ${i(x)}'s profile`:void 0),A.disabled=!i(u),N(A,"aria-label",i(u)?`${i(C)?"hide":"show"} ${i(x)}'s profile`:void 0),N(q,"src",i(d)),N(q,"alt",`avatar for ${i(x)??""}`),N(ae,"href",i(g)),N(ae,"title",P),$(Ae,i(_)),N(ne,"title",`following ${i(p)??""}, ${i(v)??""} followers`),$(se,i(x)),N(ce,"title",`posted ${i(k)??""}${i(M)?`, edited ${i(M)}`:""}, joined ${i(B)??""}`),N(oe,"href",i(r)),$(ye,`${i(O)??""} ago${i(H)?`, edited ${i(H)} ago`:""}`)},[()=>Qt(i(g),"https://")]),y(t,Q),K()}ft(["click"]);var La=S('<li class="svelte-7gwsg1"><!> <!></li>'),Ra=S('<ul class="mastodon_status_tree unstyled svelte-7gwsg1"></ul>');function bt(t,e){Z(e,!0);const a=b(()=>e.item.id),s=b(()=>e.items.filter(c=>c.in_reply_to_id===i(a)));var n=ee(),o=J(n);{var r=c=>{var l=Ra();gt(l,21,()=>i(s),m=>m.id,(m,d)=>{var g=La(),_=f(g);qe(_,{get item(){return i(d)}});var v=D(_,2);bt(v,{get item(){return i(d)},get items(){return e.items}}),h(g),y(m,g)}),h(l),y(c,l)};E(o,c=>{i(s).length&&c(r)})}y(t,n),K()}class Ua extends Error{constructor(e,a=`Unreachable case: ${e}`,s){super(a,s)}}const Wa=t=>Array.isArray(t)?t:[t],Ya=(t,e)=>`https://${t}/api/v1/statuses/${e}`,Ba=(t,e)=>`https://${t}/api/v1/statuses/${e}/context`,qa=(t,e)=>`https://${t}/api/v1/statuses/${e}/favourited_by`,wt=t=>{try{const e=new URL(t),a=$t(e.pathname,"/context").split("/").filter(Boolean),s=a[0][0]==="@"?a[0].substring(1):null;if(!s)return null;const n=a.length>1?a[a.length-1]:null;return n?{href:t,host:e.host,author:s,status_id:n}:null}catch{return null}},Ga=async(t,e,a,s,n,o,r)=>{const c=Ba(t,e),l=await Ze(c,{request:n,token:o,cache:a,return_early_from_cache:Ve,log:s,fetch:r});return l.ok?l.value:null},Xa=async(t,e,a,s,n,o,r)=>{const c=Ya(t,e),l=await Ze(c,{request:n,token:o,cache:a,return_early_from_cache:Ve,log:s,fetch:r});return l.ok?l.value:null},Va=async(t,e,a,s,n,o,r)=>{const c=qa(t,e),l=await Ze(c,{request:n,token:o,cache:a,return_early_from_cache:Ve,log:s,fetch:r});return l.ok?l.value:null},Ja=async(t,e,a,s,n)=>{const o=a?Wa(a):null,r=e.descendants;if(!r.length||!o?.length)return[];const c=new URL(t.url).host,l=new Set;for(const m of r)for(const d of o)if(d.type==="favourited_by"){if(!m.favourites_count)continue;if((await Va(c,m.id,s,n))?.find(v=>d.favourited_by.includes(v.acct))){l.add(m.id);break}}else if(d.type==="minimum_favourites"){if(m.favourites_count>=d.minimum_favourites){l.add(m.id);break}}else if(d.type==="custom"){if(d.should_include(m,t,e)){l.add(m.id);break}}else throw new Ua(d);return r.filter(m=>l.has(m.id)?m:null)};function Za(t,e){Z(e,!0);let a=T(e,"include_ancestors",3,!1),s=T(e,"include_replies",3,!1),n=T(e,"loading",15),o=T(e,"item",15),r=T(e,"status_context",15),c=T(e,"replies",15),l=T(e,"load_time",15);const m=b(()=>a()||s()),d=b(()=>e.reply_filter===void 0?s()?{type:"custom",should_include:()=>!0}:null:e.reply_filter),g=async()=>{if(!e.host||!e.id)return;const p=performance.now();n(!0),await(async x=>{var u=Xt(x,2);o(u[0]),r(u[1])})(await Promise.all([Xa(e.host,e.id,e.cache,e.log),i(m)?Ga(e.host,e.id,e.cache,e.log):null])),o()&&r()?c(await Ja(o(),r(),typeof i(d)=="function"?i(d)(o(),r()):i(d),e.cache,e.log)):c(null),n(!1),l(performance.now()-p)};var _=ee(),v=J(_);R(v,()=>e.children,()=>({item:o(),status_context:r(),replies:c(),load:g,loading:n(),load_time:l()})),y(t,_),K()}const lt=(t,e,a)=>{try{const s=localStorage.getItem(t);if(!s)return e();const n=JSON.parse(s);return a?.(n),n}catch{try{localStorage.removeItem(t)}catch{}return e()}},ct=(t,e)=>{try{e===void 0?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(e))}catch{}};var Ka=S("<div><!></div>"),Qa=S('<fieldset><div><label title="where to load the toot" class="flex_1 row"><a class="icon_button box mr_lg">🔗</a> <input/></label></div> <!></fieldset>');function $a(t,e){Z(e,!0);let a=T(e,"url",15);const s=b(()=>wt(a())),n=b(()=>!!(a()&&!i(s)));var o=Qa(),r=f(o);let c;var l=f(r),m=f(l);_t(m,"",{},{"font-size":"var(--font_size_xl)"});var d=D(m,2);mt(d);var g=p=>p.currentTarget.select();ie(d,()=>({placeholder:"> toot url",onfocus:g,...e.attrs})),h(l),h(r);var _=D(r,2);{var v=p=>{var x=Ka(),u=f(x);ia(u,{status:"error",children:(k,O)=>{Ee();var M=re("invalid Mastodon status url");y(k,M)},$$slots:{default:!0}}),h(x),X(3,x,()=>V),y(p,x)};E(_,p=>{i(n)&&p(v)})}h(o),L(p=>{c=Be(r,1,"row",null,c,p),N(m,"href",a()||void 0)},[()=>({mb_lg:i(n)})]),ha(d,a),y(t,o),K()}const en=(t,e)=>{e(!e())};var tn=S("<div></div>"),an=S('<div class="transition_wrapper svelte-esn2at"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),nn=S('<div class="icon_button_content svelte-esn2at"><div class="icon svelte-esn2at">🦣</div> <div class="button_content svelte-esn2at"><div>load toot<!> from</div> <code class="ellipsis"><!></code></div></div>'),sn=S('<div class="transition_wrapper svelte-esn2at"><!></div>'),on=S('<div class="pb_md"><a rel="noreferrer" class="display_block panel p_md"><span class="font_family_mono">↪︎</span> reply on Mastodon</a></div>'),rn=S('<div class="loaded_message svelte-esn2at"> </div>'),ln=S(`<div class="settings controls panel svelte-esn2at"><form class="w_100"><div class="mb_lg"><!></div> <fieldset class="row"><label class="row"><input type="checkbox"/>automatically load when
										scrolled onscreen</label></fieldset></form> <!></div>`),cn=S('<div><div class="toot_content svelte-esn2at"><!> <div class="main_post panel svelte-esn2at"><div class="panel bg_panel svelte-esn2at"><!></div></div> <!></div> <!> <div class="toot_controls svelte-esn2at"><div class="controls svelte-esn2at"><div class="row"><button type="button">settings</button> <div class="reset svelte-esn2at"><button type="button">reset</button><!></div></div></div> <!></div></div>');function dn(t,e){Z(e,!0);let a=T(e,"updated_url",31,()=>Vt(e.url)),s=T(e,"include_ancestors",3,!1),n=T(e,"include_replies",3,!1),o=T(e,"loading",15),r=T(e,"load_time",15),c=T(e,"initial_show_settings",3,!1),l=T(e,"show_settings",15),m=T(e,"autoload_storage_key",3,"autoload"),d=T(e,"initial_autoload",3,!1),g=T(e,"autoload",23,()=>m()?lt(m(),()=>d()):d()),_=Xe(1);const v=()=>{Jt(_),a(e.url),o(void 0),r(void 0),e.onreset?.()},p=b(()=>e.settings_storage_key&&"show_settings"+e.settings_storage_key);Fe(()=>{l()===void 0&&l(i(p)?lt(i(p),()=>c()):c())}),Fe(()=>{i(p)&&ct(i(p),l())}),Fe(()=>{m()&&ct(m(),g())});const x=b(()=>wt(a())),u=b(()=>i(x)?.status_id??null),k=b(()=>i(x)?.host??null),O=b(()=>o()!==!1&&!!i(k)),M=b(()=>o()!==void 0||a()!==e.url);var H={reset:v},B=ee(),C=J(B);return ca(C,()=>i(_),U=>{Za(U,{get host(){return i(k)},get id(){return i(u)},get include_ancestors(){return s()},get include_replies(){return n()},get cache(){return e.cache},get log(){return e.log},get reply_filter(){return e.reply_filter},get loading(){return o()},set loading(F){o(F)},get load_time(){return r()},set load_time(F){r(F)},children:(F,A)=>{let q=()=>A?.().item,fe=()=>A?.().status_context,te=()=>A?.().replies,ae=()=>A?.().load,Ae=()=>A?.().loading,ne=()=>A?.().load_time;var se=cn();let ce;var oe=f(se),ye=f(oe);{var pe=I=>{var w=tn();gt(w,21,()=>fe().ancestors,j=>j.id,(j,G)=>{qe(j,{get item(){return i(G)}})}),h(w),X(3,w,()=>V),y(I,w)};E(ye,I=>{s()&&fe()&&I(pe)})}var ve=D(ye,2),_e=f(ve),Pe=f(_e);{var Oe=I=>{var w=an(),j=f(w);da(j,()=>({"--margin":"0"})),qe(j.lastChild,{get item(){return q()}}),h(j),h(w),X(3,w,()=>V),y(I,w)},Ce=I=>{var w=sn(),j=f(w);{let G=b(()=>Ae()||!1),He=b(()=>!i(O));Ca(j,{get pending(){return i(G)},get disabled(){return i(He)},onclick:()=>ae()(),children:(ke,Ie)=>{var de=nn(),De=D(f(de),2),me=f(De),Mt=D(f(me));{var St=Y=>{var ue=re("s");y(Y,ue)};E(Mt,Y=>{(n()||s())&&Y(St)})}Ee(),h(me);var et=D(me,2),Tt=f(et);{var Et=Y=>{var ue=re();L(()=>$(ue,i(k))),y(Y,ue)},jt=Y=>{var ue=re("invalid url");y(Y,ue)};E(Tt,Y=>{i(k)?Y(Et):Y(jt,!1)})}h(et),h(De),h(de),y(ke,de)},$$slots:{default:!0}})}h(w),X(3,w,()=>V),y(I,w)};E(Pe,I=>{q()?I(Oe):I(Ce,!1)})}h(_e),h(ve);var P=D(ve,2);{var z=I=>{bt(I,{get item(){return q()},get items(){return te()}})};E(P,I=>{q()&&te()&&I(z)})}h(oe);var W=D(oe,2);{var ze=I=>{var w=on(),j=f(w);h(w),L(()=>N(j,"href",q().url)),X(3,w,()=>V),y(I,w)};E(W,I=>{q()&&I(ze)})}var be=D(W,2),we=f(be),Ke=f(we),xe=f(Ke);xe.__click=[en,l];let Qe;_t(xe,"",{},{"margin-right":"var(--space_sm)"});var $e=D(xe,2),Ne=f($e);Ne.__click=v;var xt=D(Ne);{var kt=I=>{var w=rn(),j=f(w);h(w),L(G=>$(j,`loaded in ${G??""}ms`),[()=>Math.round(ne())]),X(3,w,()=>V),y(I,w)};E(xt,I=>{ne()!==void 0&&I(kt)})}h($e),h(Ke),h(we),ua(we,(I,w)=>za?.(I,w),()=>({onintersect:({intersecting:I})=>{I&&g()&&ae()()},count:1}));var It=D(we,2);{var Dt=I=>{var w=ln(),j=f(w),G=f(j),He=f(G);$a(He,{get url(){return a()},set url(me){a(me)}}),h(G);var ke=D(G,2),Ie=f(ke),de=f(Ie);mt(de),Ee(),h(Ie),h(ke),h(j);var De=D(j,2);R(De,()=>e.settings??ht),h(w),L(()=>N(Ie,"title",g()?"replies will load automatically when scrolled intersect":"replies are not loaded until you request them")),fa(de,g),X(3,w,()=>V),y(I,w)};E(It,I=>{l()&&I(Dt)})}h(be),h(se),L((I,w)=>{ce=Be(se,1,"toot svelte-esn2at",null,ce,I),Qe=Be(xe,1,"deselectable",null,Qe,w),Ne.disabled=!i(M)},[()=>({replies:te()}),()=>({selected:l()})]),X(3,se,()=>V),y(F,se)},$$slots:{default:!0}})}),y(t,B),K(H)}ft(["click"]);var un=S('<header><h1 class="mt_xl5 mb_lg"> </h1> <p class="mb_xl5"><!></p></header>');function hn(t,e){Z(e,!0);var a=un(),s=f(a),n=f(s,!0);h(s);var o=D(s,2),r=f(o);na(r,{get item(){return e.item}}),h(o),h(a),L(()=>$(n,e.item.title)),y(t,a),K()}const fn=t=>{var e=vn();y(t,e)};var vn=S("<hr/>"),_n=S("<!>  <section><h2>Comments</h2> <!></section> <!>",1),mn=S("<article><!> <!> <!> <!></article>"),gn=S("<div>cannot find post <code> </code></div>"),yn=S('<div class="blog_post width_md"><!></div>');function pn(t,e){Z(e,!0);const a=T(e,"separator",3,fn),n=la.get().items.find(d=>d.slug===e.post.slug),o=va.maybe_get();var r=yn();Kt(d=>{L(()=>Zt.title=e.post.title)});var c=f(r);{var l=d=>{var g=mn();ie(g,()=>({...e.attrs}));var _=f(g);hn(_,{get item(){return n}});var v=D(_,2);R(v,()=>e.children);var p=D(v,2);R(p,()=>e.footer??ht);var x=D(p,2);{var u=k=>{var O=_n(),M=J(O);R(M,a);var H=D(M,2),B=D(f(H),2);{var C=Q=>{{let F=b(()=>o?.data);dn(Q,{get url(){return n.comments.url},include_replies:!0,initial_autoload:!0,reply_filter:A=>({type:"favourited_by",favourited_by:[A.account.acct]}),get settings_storage_key(){return`${n.id??""}_comments_settings`},get cache(){return i(F)}})}};E(B,Q=>{(!o||o.data!==void 0)&&Q(C)})}h(H);var U=D(H,2);R(U,a),y(k,O)};E(x,k=>{n.comments&&k(u)})}h(g),y(d,g)},m=d=>{var g=gn(),_=D(f(g)),v=f(_,!0);h(_),h(g),L(()=>$(v,e.post.slug)),y(d,g)};E(c,d=>{n?d(l):d(m,!1)})}h(r),y(t,r),K()}const bn={title:"Modeling virtual social spaces: in this house we post cat pics on Saturday",slug:"modeling-virtual-social-spaces-in-this-house-we-post-cat-pics-on-saturday",date_published:"2023-01-22T21:44:17.224Z",date_modified:"2023-01-28T17:20:51.259Z",summary:"Proposing a model for one of the central aspects of online communities: the virtual social space.",tags:["web","community","social media","design","technology","software"],comments:{url:"https://hci.social/@ryanatkn/109768104377997044",type:"mastodon"}};var wn=S(`<section><h2>Introduction</h2> <p>As I work on social software, I've been thinking about virtual social spaces and how I don't
			know enough about them. This post outlines a simple model:</p> <ul><li><strong>virtual</strong>: existing not physically but through software</li> <li><strong>social</strong>: including multiple people</li> <li><strong>space</strong>: a context containing and governing our interactions</li></ul> <p>So a virtual social space is a software-mediated context of multiplayer interaction. We're all
			familiar with them -- they include our messaging apps, social media feeds, forums etc. By
			modeling the virtual social space, we can more easily imagine reshaping them for our
			individual and collective benefit.</p></section> <section><h2>The example</h2> <p>In the software I work on, a hub is a grouping of any number of virtual social spaces. Simple!
			Except neither humans nor networks are simple, and it becomes a situation when they're
			combined. To help us along, we'll analyze virtual social spaces with a hypothetical usecase.
			Let's say I have a public web forum containing a specific space that has some very strict
			rules: participants are allowed to post only on Saturday, and posts must contain pictures of
			cats they know personally. We'll use this example to think concretely about the model.</p> <h2>The model</h2> <p>To construct our model, we define 5 powers or abilities provided to actors in the space. You
			can probably think of more, but these get us pretty far:</p> <ol><li><strong>control</strong></li> <li><strong>access</strong></li> <li><strong>interaction</strong></li> <li><strong>curation</strong></li> <li><strong>distribution</strong></li></ol> <h3>control</h3> <p><strong>Control</strong> is the manifestation of power over the space. When I first create my
			forum and the space containing the cat pictures, the software gives me control over
			everything. One example is the ability to name the space. Given the design goals of the space,
			I choose the common and descriptive name <a href="https://mastodon.social/tags/caturday">Caturday</a>. More abstractly, control is the
			center around which the space exists: I, as the creator and administrator of this tiny web
			forum, have carved a distinct boundary of control out of the infinite virtual void. The
			software doesn't necessarily have to grant all of that control to me, but it does in this
			case. In our model, the control power controls the other 4 powers. Naturally.</p> <h3>access</h3> <p>Now that I have control over my tiny world, I want others to join so we can enjoy it together. <strong>Access</strong> is the ability to enter the space. It's similar to the "read permission" of a document. For Caturday
			I exercise my control over the space to choose public access, meaning everyone is welcome, even
			those creepy surveillance drones disguised as well-meaning people, because I'm prioritizing open
			participation over privacy to get more cat pics and joy. Additionally, even though we have a Saturday-themed
			space, actors can <em>read</em> posts any time. Now that people can access it, our virtual space
			is social!</p> <h3>interaction</h3> <p>We have a publicly accessible social space, but nothing much is happening yet. <strong>Interaction</strong> describes the things people can do in the space. It's like the "write permission" of a document.
			To make Caturday live up to its name, I again exercise my control, this time defining the rules
			of interaction in the space:</p> <ul><li>actors can <em>post</em> only on Saturday</li> <li>each post must include exactly one image (photograph, painting, etc) of a cat or cats that
				the poster personally knows, with an optional short bit of text</li> <li>actors can <em>react</em> to each others' posts, on Saturday only, in one of three ways: an emoji,
				a BIG emoji, or a tiny bit of text (let's say max 24 characters)</li></ul> <h3>curation</h3> <p>Now that we've defined the rules of interaction, let's talk about the meta layer of activities
			around those interactions. When people visit the space with cat pictures, I want them to be
			able to choose how they see and use the content. People may choose to:</p> <ul><li>view all of the posts in a single feed with the most recent at the top</li> <li>view posts sorted by most all-time big emoji reactions, excluding the text reactions</li> <li>view posts grouped by cat, so we can see each cat change over time</li> <li>view only the posts they've reacted to, with the most recent listed first, so they can show
				their friend their favorites in person</li> <li>today is Saturday! view the flurry activity with random sorting, excluding posts they've
				already seen</li></ul> <p>And so on, deep into the kaleidoscope of human creativity.</p> <p>In our model, we define these meta-interactions of organizing and managing posts as <strong>curation</strong>. Depending on your point of view, good curation may be even more important than the core
			interactions of posting and reacting. If our goal is to maximize our collaborative agency,
			creativity, and utility (joy) within the constraints of the space, which it is in this case,
			we want users to be able to create those views themselves, and then easily share them with
			others. So, I exercise control over the space to grant participants various powers of
			curation.</p> <h3>distribution</h3> <p>We now have posts, reactions, and all sorts of ways to view them. The final power in our model
			is <strong>distribution</strong>, the ability to communicate the space's data beyond its
			boundaries. In our hypothetical, we explicitly support distribution in a few open-ended ways,
			so the joy of each post can spread wherever it's wanted:</p> <ul><li>social media share buttons (only to the good sites in our case)</li> <li>a lightweight way to embed a post on any website</li> <li>a data service that sends post data to anyone who asks for it (an API)</li></ul> <p>By intentionally designing how distribution works in the space, we unlock another dimension of
			creativity that reaches the wider world beyond our little web forum. Technically every reader
			already has the data, but explicit distribution powers enable an ecosystem more readily.</p> <h2>Conclusion</h2> <p>We started with the idea of control over a virtual social space, and then:</p> <ul><li>decided who gets access, public in this case (and mostly ungated, but that's another post)</li> <li>and what interactions are available to them</li> <li>and then how they're able to curate the data from those interactions, creating new metadata
				and interactions</li> <li>and then how we can support distribution of that data and metadata to the wider world</li></ul> <p>This model seems useful for exploring the rich territory available to us when designing our
			virtual social spaces.</p> <p>So when dog folks come along with their predictable request, we can say, ah yes, they want us
			to exercise our control over the space to change the rules of interaction, so every dog can
			have their day too.</p></section> <hr/> <section><h2>Acknowledgements</h2> <p>Special thanks to <a href="https://sipa.fiu.edu/people/faculty/modern-languages/rosario-medardo.html">Medardo Rosario</a> for help with revisions.</p> <p>One of my primary influences on this work is "Modular Politics: Toward a Governance Layer for
			Online Communities" (<a href="https://arxiv.org/abs/2005.13701">arxiv.org/abs/2005.13701</a>)
			by Nathan Schneider (<a href="https://nathanschneider.info/">nathanschneider.info</a>) and
			colleagues.</p> <p>My thinking on this subject is rooted in the perspective of consent for all involved actors,
			informed by the paper "Yes: Affirmative Consent as a Theoretical Framework for Understanding
			and Imagining Social Platforms" (<a href="https://consentful.systems">consentful.systems</a>)
			by Jane Im (<a href="https://imjane.net/">imjane.net</a>) and colleagues.</p> <p>I used ChatGPT (<a href="https://chatgpt.com/">chatgpt.com</a>) not for writing any text but
			to brainstorm the model when I was midway through. It didn't give me the final answers but it
			accelerated the process, and probably influenced the result.</p></section> <hr/> <section><h2>P.S.</h2> <p>Some questions from this:</p> <ul><li>We've defined some hard-to-enforce rules of interaction, like personally knowing the cat.
				How could authentic participation be incentivized/enforced?</li> <li>What mechanisms can we use to collectively exert control over each of the other powers in
				the model? What could it look like to have public control over the space?</li> <li>How does gating fit into this model? What are the ways we can gate public and private
				access? And the other powers?</li></ul></section>`,1);function Nn(t){pn(t,{get post(){return bn},children:(e,a)=>{var s=wn();Ee(10),y(e,s)},$$slots:{default:!0}})}export{Nn as component};
